'use strict';

/**
 * CustomMap containing SVG paths needed by CustomCmmnRenderer.
 */

function CustomPathMap() {

var PATH_CRITICALITY_NONE = ' m {mx}, {my} m 18.659622,17.565351 q -1.07487,0 -1.619195,1.061089 -0.537435,1.054199 -0.537435,3.176378 0,2.115289 0.537435,3.176378 0.544325,1.054199 1.619195,1.054199 1.08176,0 1.619195,-1.054199 0.544325,-1.061089 0.544325,-3.176378 0,-2.122179 -0.544325,-3.176378 -0.537435,-1.061089 -1.619195,-1.061089 z m 0,-1.102431 q 1.729438,0 2.638943,1.371148 0.916395,1.364258 0.916395,3.96875 0,2.597602 -0.916395,3.96875 -0.909505,1.364258 -2.638943,1.364258 -1.729438,0 -2.645834,-1.364258 -0.909505,-1.371148 -0.909505,-3.96875 0,-2.604492 0.909505,-3.96875 0.916396,-1.371148 2.645834,-1.371148 z';

var PATH_CRITICALITY_LOW = 'm {mx}, {my} m 30.548152,25.764678 h 4.857585 v 1.171332 h -6.531901 v -1.171332 q 0.792372,-0.819933 2.15663,-2.197971 1.371148,-1.384928 1.722547,-1.784559 0.668349,-0.751031 0.930176,-1.267795 0.268717,-0.523655 0.268717,-1.026639 0,-0.819933 -0.578776,-1.336697 -0.571885,-0.516764 -1.495171,-0.516764 -0.654568,0 -1.384928,0.227376 -0.72347,0.227376 -1.550293,0.689019 v -1.405599 q 0.840603,-0.337619 1.570963,-0.509874 0.73036,-0.172255 1.336697,-0.172255 1.598525,0 2.549371,0.799263 0.950846,0.799262 0.950846,2.135959 0,0.633897 -0.241157,1.205783 -0.234266,0.564996 -0.861273,1.336697 -0.172255,0.199816 -1.095541,1.157552 -0.923285,0.950846 -2.604492,2.666504 z m -5.691297,-0.578776 h 1.45383 v 1.750108 h -1.45383 z m -6.008246,-7.620551 q -1.07487,0 -1.619195,1.061089 -0.537435,1.054199 -0.537435,3.176378 0,2.115289 0.537435,3.176378 0.544325,1.054199 1.619195,1.054199 1.081759,0 1.619194,-1.054199 0.544325,-1.061089 0.544325,-3.176378 0,-2.122179 -0.544325,-3.176378 -0.537435,-1.061089 -1.619194,-1.061089 z m 0,-1.102431 q 1.729437,0 2.638943,1.371148 0.916395,1.364258 0.916395,3.96875 0,2.597602 -0.916395,3.96875 -0.909506,1.364258 -2.638943,1.364258 -1.729438,0 -2.645834,-1.364258 -0.909505,-1.371148 -0.909505,-3.96875 0,-2.604492 0.909505,-3.96875 0.916396,-1.371148 2.645834,-1.371148 z';

var PATH_CRITICALITY_MEDIUM = 'm {mx}, {my} m 29.363039,16.648956 h 5.463922 v 1.171332 h -4.189236 v 2.52181 q 0.303168,-0.103353 0.606336,-0.151584 0.303169,-0.05512 0.606337,-0.05512 1.722548,0 2.728516,0.943956 1.005968,0.943956 1.005968,2.556261 0,1.660536 -1.033529,2.583822 -1.033529,0.916395 -2.914551,0.916395 -0.647678,0 -1.322916,-0.110243 -0.668349,-0.110243 -1.384929,-0.330729 v -1.398709 q 0.620118,0.337619 1.281576,0.502984 0.661458,0.165364 1.398709,0.165364 1.192003,0 1.887912,-0.627007 0.695909,-0.627007 0.695909,-1.701877 0,-1.07487 -0.695909,-1.701877 -0.695909,-0.627007 -1.887912,-0.627007 -0.558106,0 -1.116211,0.124023 -0.551216,0.124023 -1.129992,0.385851 z m -4.506184,8.536946 h 1.45383 v 1.750108 h -1.45383 z m -6.008246,-7.620551 q -1.07487,0 -1.619195,1.061089 -0.537435,1.054199 -0.537435,3.176378 0,2.115289 0.537435,3.176378 0.544325,1.054199 1.619195,1.054199 1.081759,0 1.619194,-1.054199 0.544325,-1.061089 0.544325,-3.176378 0,-2.122179 -0.544325,-3.176378 -0.537435,-1.061089 -1.619194,-1.061089 z m 0,-1.102431 q 1.729437,0 2.638943,1.371148 0.916395,1.364258 0.916395,3.96875 0,2.597602 -0.916395,3.96875 -0.909506,1.364258 -2.638943,1.364258 -1.729438,0 -2.645834,-1.364258 -0.909505,-1.371148 -0.909505,-3.96875 0,-2.604492 0.909505,-3.96875 0.916396,-1.371148 2.645834,-1.371148 z';

//var PATH_CRITICALITY_HIGH = 'm {mx}, {my} m 115.00418,91.283498 q 0,-0.778591 -0.54433,-1.267795 -0.54432,-0.496094 -1.42627,-0.496094 -1.07487,0 -1.77767,0.647678 -0.69591,0.640788 -0.69591,1.626085 0,0.785482 0.53055,1.247125 0.53743,0.461643 1.44694,0.461643 1.08176,0 1.77078,-0.627008 0.69591,-0.627007 0.69591,-1.591634 z m 0.70969,-4.795573 q 0,-0.654568 -0.48232,-1.054199 -0.48231,-0.399631 -1.28157,-0.399631 -0.94396,0 -1.55719,0.530545 -0.60633,0.530545 -0.60633,1.329807 0,0.689019 0.47542,1.10932 0.48231,0.420302 1.27469,0.420302 0.95084,0 1.56407,-0.544325 0.61323,-0.551215 0.61323,-1.391819 z m -0.94396,2.50114 q 0.77859,0.296278 1.192,0.895724 0.41341,0.599447 0.41341,1.446941 0,1.426269 -1.10243,2.349555 -1.10243,0.923285 -2.84564,0.923285 -1.4814,0 -2.35645,-0.72347 -0.87505,-0.73036 -0.87505,-1.943034 0,-1.10243 0.75103,-1.956814 0.75103,-0.861274 1.95681,-1.09554 -0.72347,-0.248047 -1.10243,-0.764811 -0.37896,-0.523655 -0.37896,-1.267795 0,-1.247125 1.03353,-2.080838 1.04042,-0.840603 2.63205,-0.840603 1.32981,0 2.16352,0.682129 0.8406,0.675238 0.8406,1.722547 0,0.909505 -0.627,1.626085 -0.62012,0.70969 -1.69499,1.026639 z m -9.37755,3.665581 h 1.45383 l -0.33762,1.750109 h -1.45383 z m -4.75423,-8.722981 q 1.39871,0 2.13596,0.930175 0.74414,0.930176 0.74414,2.673394 0,1.322917 -0.3514,2.632053 -0.34451,1.302246 -0.97152,2.335775 -0.64079,1.033529 -1.50895,1.570963 -0.861273,0.530545 -1.908582,0.530545 -1.350478,0 -2.087728,-0.937066 -0.737251,-0.937066 -0.737251,-2.666504 0,-1.309136 0.3514,-2.618272 0.35829,-1.316027 0.992188,-2.342665 0.633897,-1.033529 1.481391,-1.570963 0.854383,-0.537435 1.860352,-0.537435 z m -0.0827,1.10243 q -0.52366,0 -0.999081,0.282498 -0.468533,0.275608 -0.847493,0.819933 -0.633898,0.909505 -1.012858,2.273763 -0.372071,1.357367 -0.372071,2.790527 0,1.136881 0.399631,1.722548 0.406522,0.578776 1.192003,0.578776 0.551216,0 1.019749,-0.275608 0.46853,-0.282498 0.84749,-0.826823 0.62701,-0.902615 0.99219,-2.259982 0.37207,-1.364258 0.37207,-2.804308 0,-1.136882 -0.40652,-1.715658 -0.39963,-0.585666 -1.18511,-0.585666 z';

var PATH_CRITICALITY_HIGH = 'm {mx}, {my} m 99.605588,41.138662 q -0.992188,0 -1.564074,0.530545 -0.564995,0.530545 -0.564995,1.46072 0,0.930176 0.564995,1.460721 0.571886,0.530545 1.564074,0.530545 0.992182,0 1.564072,-0.530545 0.57189,-0.537435 0.57189,-1.460721 0,-0.930175 -0.57189,-1.46072 -0.56499,-0.530545 -1.564072,-0.530545 z m -1.391819,-0.592556 q -0.895725,-0.220486 -1.398709,-0.833713 -0.496093,-0.613227 -0.496093,-1.495172 0,-1.233344 0.875054,-1.949924 0.881944,-0.716579 2.411567,-0.716579 1.536512,0 2.411562,0.716579 0.87506,0.71658 0.87506,1.949924 0,0.881945 -0.50299,1.495172 -0.49609,0.613227 -1.38492,0.833713 1.00596,0.234266 1.56407,0.916395 0.565,0.682129 0.565,1.667426 0,1.495172 -0.9164,2.294434 -0.90951,0.799262 -2.611382,0.799262 -1.701878,0 -2.618273,-0.799262 -0.909505,-0.799262 -0.909505,-2.294434 0,-0.985297 0.564995,-1.667426 0.564996,-0.682129 1.570964,-0.916395 z m -0.509874,-2.197971 q 0,0.799262 0.496094,1.247125 0.502984,0.447862 1.405599,0.447862 0.895722,0 1.398712,-0.447862 0.50987,-0.447863 0.50987,-1.247125 0,-0.799262 -0.50987,-1.247125 -0.50299,-0.447862 -1.398712,-0.447862 -0.902615,0 -1.405599,0.447862 -0.496094,0.447863 -0.496094,1.247125 z m -5.567274,5.925564 h 1.45383 v 1.750109 h -1.45383 z m -6.008246,-7.620551 q -1.07487,0 -1.619195,1.061089 -0.537435,1.0542 -0.537435,3.176378 0,2.115289 0.537435,3.176378 0.544325,1.0542 1.619195,1.0542 1.08176,0 1.619194,-1.0542 0.544326,-1.061089 0.544326,-3.176378 0,-2.122178 -0.544326,-3.176378 -0.537434,-1.061089 -1.619194,-1.061089 z m 0,-1.10243 q 1.729437,0 2.638943,1.371148 0.916395,1.364257 0.916395,3.968749 0,2.597602 -0.916395,3.96875 -0.909506,1.364258 -2.638943,1.364258 -1.729438,0 -2.645834,-1.364258 -0.909505,-1.371148 -0.909505,-3.96875 0,-2.604492 0.909505,-3.968749 0.916396,-1.371148 2.645834,-1.371148 z';

var PATH_CRITICALITY_CRITICAL = 'm {mx}, {my} m 16.113203,25.57569 h 2.273763 v -7.847927 l -2.473579,0.496094 v -1.267795 l 2.459798,-0.496094 h 1.391819 v 9.115722 h 2.273763 v 1.171333 h -5.925564 z';

var PATH_CHAIN_1 = 'm {mx}, {my} m 16.113203,25.57569 h 2.273763 v -7.847927 l -2.473579,0.496094 v -1.267795 l 2.459798,-0.496094 h 1.391819 v 9.115722 h 2.273763 v 1.171333 h -5.925564 z';

var PATH_CHAIN_2 = 'm {mx}, {my} m 17.070939,25.764678 h 4.857585 v 1.171332 h -6.531901 v -1.171332 q 0.792372,-0.819933 2.15663,-2.197971 1.371148,-1.384928 1.722547,-1.784559 0.668349,-0.751031 0.930176,-1.267795 0.268718,-0.523655 0.268718,-1.026639 0,-0.819933 -0.578776,-1.336697 -0.571886,-0.516764 -1.495172,-0.516764 -0.654568,0 -1.384928,0.227376 -0.72347,0.227376 -1.550293,0.689019 v -1.405599 q 0.840603,-0.337619 1.570963,-0.509874 0.730361,-0.172255 1.336697,-0.172255 1.598525,0 2.549371,0.799263 0.950846,0.799262 0.950846,2.135959 0,0.633897 -0.241156,1.205783 -0.234267,0.564996 -0.861274,1.336697 -0.172255,0.199816 -1.095541,1.157552 -0.923285,0.950846 -2.604492,2.666504 z';

var PATH_CHAIN_3 = 'm{mx}, {my} m 20.088843,21.389407 q 0.999078,0.213596 1.557183,0.888834 0.564996,0.675239 0.564996,1.667427 0,1.522732 -1.047309,2.356445 -1.047309,0.833713 -2.976563,0.833713 -0.647678,0 -1.336697,-0.130914 -0.682129,-0.124023 -1.412489,-0.37896 v -1.343587 q 0.578776,0.337619 1.267795,0.509874 0.689019,0.172254 1.44005,0.172254 1.309136,0 1.991265,-0.516764 0.689019,-0.516764 0.689019,-1.502061 0,-0.909506 -0.640787,-1.41938 -0.633898,-0.516764 -1.77078,-0.516764 h -1.198893 v -1.143772 h 1.254015 q 1.026638,0 1.570964,-0.406521 0.544325,-0.413411 0.544325,-1.185113 0,-0.792372 -0.564996,-1.212673 -0.558106,-0.427192 -1.605415,-0.427192 -0.571885,0 -1.226453,0.124023 -0.654569,0.124024 -1.44005,0.385851 v -1.240234 q 0.792372,-0.220486 1.481391,-0.33073 0.695909,-0.110243 1.309136,-0.110243 1.584744,0 2.508029,0.72347 0.923286,0.71658 0.923286,1.943034 0,0.854384 -0.489204,1.44694 -0.489203,0.585666 -1.391818,0.813043 z';

//var PATH_CHAIN_4 = 'm{mx}, {my} m 59.761581,32.413713 -3.513997,5.491482 h 3.513997 z m -0.36518,-1.212673 h 1.750109 v 6.704155 h 1.46761 v 1.157552 h -1.46761 v 2.425347 H 59.761581 V 39.062747 H 55.117593 V 37.71916 Z';
//var PATH_CHAIN_5 = 'm{mx}, {my} m 15.885826,16.648956 h 5.463922 v 1.171332 h -4.189236 v 2.52181 q 0.303168,-0.103353 0.606337,-0.151584 0.303168,-0.05512 0.606336,-0.05512 1.722548,0 2.728516,0.943956 1.005968,0.943956 1.005968,2.556261 0,1.660536 -1.033529,2.583822 -1.033528,0.916395 -2.914551,0.916395 -0.647677,0 -1.322916,-0.110243 -0.668349,-0.110243 -1.384929,-0.330729 v -1.398709 q 0.620118,0.337619 1.281576,0.502984 0.661458,0.165364 1.398709,0.165364 1.192003,0 1.887912,-0.627007 0.695909,-0.627007 0.695909,-1.701877 0,-1.07487 -0.695909,-1.701877 -0.695909,-0.627007 -1.887912,-0.627007 -0.558106,0 -1.116211,0.124023 -0.551215,0.124023 -1.129992,0.385851 z';

var PATH_EVENT_ERROR = 'm {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z';

this.customPathMap = {

    'CRITICALITY_NONE': {
        d: PATH_CRITICALITY_NONE,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },
        
    'CRITICALITY_LOW': {
        d: PATH_CRITICALITY_LOW,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'CRITICALITY_MEDIUM': {
        d: PATH_CRITICALITY_MEDIUM,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'CRITICALITY_HIGH': {
        d: PATH_CRITICALITY_HIGH,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'CRITICALITY_CRITICAL': {
        d: PATH_CRITICALITY_CRITICAL,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'CHAIN_1': {
        d: PATH_CHAIN_1,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'CHAIN_2': {
        d: PATH_CHAIN_2,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'CHAIN_3': {
        d: PATH_CHAIN_3,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'EVENT_ERROR': {
        d: PATH_EVENT_ERROR,
        height: 36,
        width: 36,
        heightElements: [0.023, 8.737, 8.151, 16.564, 10.591, 8.714],
        widthElements: [0.085, 6.672, 6.97, 4.273, 5.337, 6.636]
    },
/*
    'CHAIN_4': {
        d: PATH_CHAIN_4,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    },

    'CHAIN_5': {
        d: PATH_CHAIN_5,
        height: 14,
        width: 3,
        heightElements: [],
        widthElements: []
    }
*/
};

this.getRawPath = function getRawPath(pathId) {
    return this.customPathMap[pathId].d;
};

this.getScaledPath = function getScaledPath(pathId, param) {
    var rawPath = this.customPathMap[pathId];

    // positioning
    // compute the start point of the path
    var mx, my;



    if (param.abspos) {
        mx = param.abspos.x;
        my = param.abspos.y;
    } else {
        mx = param.containerWidth * param.position.mx;
        my = param.containerHeight * param.position.my;
    }

  

    var coordinates = {}; // map for the scaled coordinates
    if (param.position) {

        // path
        var heightRatio = (param.containerHeight / rawPath.height) * param.yScaleFactor;
        var widthRatio = (param.containerWidth / rawPath.width) * param.xScaleFactor;


        // Apply height ratio
        for (var heightIndex = 0; heightIndex < rawPath.heightElements.length; heightIndex++) {
            coordinates['y' + heightIndex] = rawPath.heightElements[heightIndex] * heightRatio;
        }

        // Apply width ratio
        for (var widthIndex = 0; widthIndex < rawPath.widthElements.length; widthIndex++) {
            coordinates['x' + widthIndex] = rawPath.widthElements[widthIndex] * widthRatio;
        }
    }


    // Apply value to raw path
    var path = format(
        rawPath.d, {
        mx: mx,
        my: my,
        e: coordinates
        }
    );
        return path;
    };
}

module.exports = CustomPathMap;

// helpers /////////////////

// copied from https://github.com/adobe-webplatform/Snap.svg/blob/master/src/svg.js
var tokenRegex = /\{([^}]+)\}/g,
    objNotationRegex = /(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g; // matches .xxxxx or ["xxxxx"] to run over object properties

function replacer(all, key, obj) {
    var res = obj;
    key.replace(objNotationRegex, function(all, name, quote, quotedName, isFunc) {
        name = name || quotedName;
        if (res) {
            if (name in res) {
            res = res[name];
            }
            typeof res == 'function' && isFunc && (res = res());
        }
    });
    res = (res == null || res == obj ? all : res) + '';

    return res;
}

function format(str, obj) {
    return String(str).replace(tokenRegex, function(all, key) {
        return replacer(all, key, obj);
    });
}
